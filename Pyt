import random

# Pixel fire generator settings
width = 48
height = 28
scale = 6
palette = [
    (10, 10, 10),  # dark background
    (180, 0, 0),   # deep red
    (255, 80, 0),  # orange red
    (255, 140, 0), # flame orange
    (255, 200, 50),# yellow
    (255, 255, 255) # white hot
]

def generate_fire_frame():
    # Use a 2D list (list of lists) to store pixel data
    pixels = [[(0, 0, 0) for _ in range(width)] for _ in range(height)]

    for y in range(height):
        for x in range(width):
            if y > height - 6:
                # Hot pixels at the bottom
                pixels[y][x] = random.choice(palette[1:])
            else:
                # Sample from pixels below with some variation
                source_y = min(height - 1, y + random.randint(1, 3))
                source_x = min(width - 1, max(0, x + random.randint(-1, 1)))
                pixels[y][x] = pixels[source_y][source_x]
    return pixels

def save_ppm(pixel_data, output_path, scale):
    """
    Saves the pixel data as a simple ASCII PPM (P3) file.
    Also handles the scaling.
    """
    scaled_width = width * scale
    scaled_height = height * scale

    with open(output_path, 'w') as f:
        # PPM header
        f.write(f"P3\n")
        f.write(f"{scaled_width} {scaled_height}\n")
        f.write(f"255\n") # Max color value

        # Write pixel data
        for y in range(scaled_height):
            # Map scaled Y back to original Y
            original_y = y // scale
            for x in range(scaled_width):
                # Map scaled X back to original X
                original_x = x // scale
                r, g, b = pixel_data[original_y][original_x]
                f.write(f"{r} {g} {b} ")
            f.write("\n")

# Create flame animation frame
frame_data = generate_fire_frame()
output = "/mnt/data/pixel_fire.ppm" # Change extension to .ppm
save_ppm(frame_data, output, scale)

print("Pixel fire saved to:", output)
